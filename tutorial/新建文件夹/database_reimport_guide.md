# 数据库重新导入完整指南

## ⚠️ 重要概念澄清

**关键理解：zy.sql 和 chl.sql 不是两个数据库，而是同一个数据库(zy)的两个部分！**

### 文件作用说明：

**zy.sql** → **数据库结构文件**
- 只定义表结构、字段、索引
- 不包含任何实际数据  
- 相当于空的"数据库框架"

**chl.sql** → **示例数据文件**
- 只包含数据插入语句(INSERT)
- 需要基于已存在的表结构执行
- 包含症状、患者、病证等完整示例数据

### 数据库配置说明：

**数据库连接配置中应该填：**
- 数据库名：**zy** ← 只能填这一个
- ❌ chl.sql只是数据文件，不是数据库名！

### 正确执行流程：
1. 创建数据库：`zy`
2. 导入数据：执行 chl.sql（它会自动创建表结构）
3. 系统连接：配置数据库名为"zy"

## 方案对比

### 方案1：使用HeidiSQL重新导入chl.sql（推荐）
**优点：**
- 保留完整的示例数据（包括症状、患者信息等）
- 操作简单直观
- 一次性解决所有数据问题

**缺点：**
- 需要手动操作
- 需要几分钟时间

### 方案2：重新安装MariaDB
**优点：**
- 彻底清理环境
- 从零开始

**缺点：**
- 耗时较长（下载+安装+配置）
- 可能遇到兼容性问题
- 仍需要重新导入数据

## 推荐操作步骤（使用HeidiSQL）

### 第一步：备份现有数据（可选）
如果担心数据丢失，可以先导出重要数据：
1. 在HeidiSQL中连接到数据库
2. 右键点击"zy"数据库 → "导出数据库为SQL"
3. 保存到安全位置

### 第二步：删除现有数据库
1. 在HeidiSQL中连接到MySQL服务器
2. 找到"zy"数据库
3. 右键点击"zy" → "删除"或"Drop"
4. 确认删除

### 第三步：重新创建数据库
1. 右键点击服务器名称 → "创建新数据库"
2. 数据库名称：`zy` **← 注意：这里填zy，不是chl**
3. 字符集：`utf8mb4`
4. 排序规则：`utf8mb4_unicode_ci`
5. 点击"确定"

### 第四步：导入chl.sql文件
1. 在HeidiSQL中选中刚创建的"zy"数据库
2. 点击工具栏的"打开SQL文件"按钮（或按Ctrl+O）
3. 选择文件：`e:\Programs\zhongyi-5.25.1119\tutorial\chl.sql`
4. 点击"运行"按钮（绿色三角形）
5. 等待导入完成（可能需要几分钟）

### 第五步：验证导入结果
执行以下SQL查询验证：
```sql
-- 检查各表数据量
SELECT '中药' as 表名, COUNT(*) as 记录数 FROM 中药
UNION ALL
SELECT '常规资料', COUNT(*) FROM 常规资料
UNION ALL
SELECT '医案', COUNT(*) FROM 医案
UNION ALL
SELECT '诊断', COUNT(*) FROM 诊断
UNION ALL
SELECT '病证', COUNT(*) FROM 病证
UNION ALL
SELECT '辩证', COUNT(*) FROM 辩证;

-- 检查示例数据
SELECT * FROM 常规资料 LIMIT 5;
SELECT * FROM 病证 LIMIT 5;
SELECT * FROM 诊断 LIMIT 5;
```

## 预期结果
导入成功后应该看到：
- 中药表：约600+条记录
- 常规资料表：包含患者信息
- 病证表：包含各种症状
- 诊断表：包含诊断信息
- 其他表：相应数据

## 注意事项
1. 确保[chl.sql](file:///e:/Programs/zhongyi-5.25.1119/tutorial/chl.sql)文件完整无损
2. 导入过程中不要关闭HeidiSQL
3. 如果遇到编码问题，确保HeidiSQL使用UTF-8编码
4. 导入完成后重启中医系统程序

## 故障排除
如果导入过程中出现错误：
1. 检查SQL文件是否完整
2. 确认数据库字符集设置正确
3. 查看具体错误信息，通常可以继续执行
4. 必要时可以分段导入（按表分别导入）

这个方法能够从根本上解决数据为空的问题，恢复完整的示例数据。